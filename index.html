<!DOCTYPE html>
<html>

<head>
    <!-- ls dubs | sed "s/.*/'&',/" | tr -d "\n" > files.js -->

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@300;400&display=swap" rel="stylesheet">

    <title>Many Video dubbing with Google Cloud</title>
    <style>
        body {
            font-family: 'Open Sans', sans-serif;
        }
        
        video {
            width: 600px;
        }
        
        select {
            font-size: 1.2em;
            border-radius: 20px;
            padding: 10px;
        }
    </style>
</head>

<body>
    <h1>Global Video dubbing with Google Cloud</h1>
    <!-- <input type="file" id="video-file" accept="video/*"> -->

    <br>
    <video id="video-player" src="test_video.mp4" controls muted></video>
    <br>
    <select id="audio-selection">
        <option value="English [ğŸ‡¬ğŸ‡§] (Original).mp3" selected>English [ğŸ‡¬ğŸ‡§] (Original)</option>
    </select>
    <br>
    <audio hidden id="audio-player" controls src="dubs/English [ğŸ‡¬ğŸ‡§] (Original).mp3"></audio>

    <script>
        const dubs = ['Afrikaans [ğŸ‡¿ğŸ‡¦].mp3', 'Arabic [ğŸ‡¦ğŸ‡ª].mp3', 'Bangla [ğŸ‡®ğŸ‡³].mp3', 'Basque [ğŸ‡ªğŸ‡¸].mp3', 'Bulgarian [ğŸ‡§ğŸ‡¬].mp3', 'Catalan [ğŸ‡ªğŸ‡¸].mp3', 'Chinese (China) [ğŸ‡¨ğŸ‡³].mp3',
            'Chinese (Taiwan) [ğŸ‡¹ğŸ‡¼].mp3', 'Chinese [ğŸ‡¨ğŸ‡³].mp3', 'Czech [ğŸ‡¨ğŸ‡¿].mp3', 'Danish [ğŸ‡©ğŸ‡°].mp3', 'Dutch [ğŸ‡§ğŸ‡ª].mp3', 'Filipino [ğŸ‡µğŸ‡­].mp3',
            'Finnish [ğŸ‡«ğŸ‡®].mp3', 'French [ğŸ‡¨ğŸ‡¦].mp3', 'Galician [ğŸ‡ªğŸ‡¸].mp3', 'German [ğŸ‡©ğŸ‡ª].mp3', 'Greek [ğŸ‡¬ğŸ‡·].mp3', 'Gujarati [ğŸ‡®ğŸ‡³].mp3', 'Hebrew [ğŸ‡®ğŸ‡±].mp3', 'Hindi [ğŸ‡®ğŸ‡³].mp3',
            'Hungarian [ğŸ‡­ğŸ‡º].mp3', 'Icelandic [ğŸ‡®ğŸ‡¸].mp3', 'Indonesian [ğŸ‡®ğŸ‡©].mp3', 'Italian [ğŸ‡®ğŸ‡¹].mp3', 'Japanese [ğŸ‡¯ğŸ‡µ].mp3', 'Kannada [ğŸ‡®ğŸ‡³].mp3', 'Korean [ğŸ‡°ğŸ‡·].mp3', 'Latvian [ğŸ‡±ğŸ‡»].mp3', 'Lithuanian [ğŸ‡±ğŸ‡¹].mp3',
            'Malay [ğŸ‡²ğŸ‡¾].mp3', 'Malayalam [ğŸ‡®ğŸ‡³].mp3', 'Marathi [ğŸ‡®ğŸ‡³].mp3', 'Norwegian [ğŸ‡³ğŸ‡´].mp3', 'Polish [ğŸ‡µğŸ‡±].mp3', 'Portuguese [ğŸ‡§ğŸ‡·].mp3', 'Punjabi [ğŸ‡®ğŸ‡³].mp3', 'Romanian [ğŸ‡·ğŸ‡´].mp3', 'Russian [ğŸ‡·ğŸ‡º].mp3', 'Serbian [ğŸ‡·ğŸ‡¸].mp3',
            'Slovak [ğŸ‡¸ğŸ‡°].mp3', 'Spanish [ğŸ‡ªğŸ‡¸].mp3', 'Swedish [ğŸ‡¸ğŸ‡ª].mp3', 'Tamil [ğŸ‡®ğŸ‡³].mp3', 'Telugu [ğŸ‡®ğŸ‡³].mp3', 'Thai [ğŸ‡¹ğŸ‡­].mp3', 'Turkish [ğŸ‡¹ğŸ‡·].mp3', 'Ukrainian [ğŸ‡ºğŸ‡¦].mp3', 'Vietnamese [ğŸ‡»ğŸ‡³].mp3'
        ]

        const dropdown = document.getElementById('audio-selection');
        const videoPlayer = document.getElementById('video-player');
        const audioPlayer = document.getElementById('audio-player');

        function sync() {
            audioPlayer.currentTime = videoPlayer.currentTime;
        }

        audioPlayer.addEventListener('loadeddata', function() {
            console.log('MP3 loaded into audio player');
            videoPlayer.muted = true;
            sync()
            if (!videoPlayer.paused)
                audioPlayer.play();
            // Your custom code here
        });

        videoPlayer.addEventListener('seeked', function() {

            console.log('seeked')
            if (!videoPlayer.paused) {
                sync()
                audioPlayer.play();
            }
        });


        videoPlayer.addEventListener('pause', function() {
            console.log('Video paused');
            sync()
            audioPlayer.pause();
        });

        videoPlayer.addEventListener('play', function() {
            console.log('Video played');
            sync()
            audioPlayer.play();
        });


        dubs.forEach(function(option) {
            let optionElement = document.createElement('option');
            optionElement.text = option.split('.')[0];
            optionElement.value = option;
            dropdown.add(optionElement);
        });

        // document.getElementById('video-file').addEventListener('change', function(event) {
        //     var videoPlayer = document.getElementById('video-player');
        //     var file = event.target.files[0];
        //     var videoURL = URL.createObjectURL(file);
        //     videoPlayer.src = videoURL;
        // });

        document.getElementById('audio-selection').addEventListener('change', function(event) {
            let audioFile = 'dubs/' + event.target.value;
            audioPlayer.src = audioFile;

        });
    </script>
</body>

</html>
